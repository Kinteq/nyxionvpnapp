# IP Limit Service в Blitz Panel

## Что это?
Inactive IP Limit Service — сервис ограничения количества IP адресов, с которых одновременно может работать один VPN ключ.

## Как работает?
- При активации: ключ разрешает работать только с N IP адресов (например, 3)
- Если IP подключается первый раз, он добавляется в список активных IP
- Если максимум достигнут, новый IP будет отклонен (либо автоматически удалится старый неиспользуемый)
- Слово "Inactive" означает, что он отключает подключения с неактивных IP (которые не использовались некоторое время)

## Статус в панели
- `disabled` = отключен (ключ может работать с любыми IP)
- `enabled` = включен (ограничение активно)

## Как включить в API?

Blitz V1 API для установки лимита IP:
```bash
# Установить лимит на 3 IP
curl -X PATCH http://127.0.0.1:28260/api/v1/users/vpn_123456/inactivelimit \
  -H "Authorization: TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"limit": 3, "enabled": true}'
```

Или через основные параметры пользователя:
```bash
curl -X PUT http://127.0.0.1:28260/api/v1/users/vpn_123456 \
  -H "Authorization: TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"ip_limit": 3, "ip_limit_enabled": true}'
```

## Текущее решение для Nyxion VPN

Решили не полагаться на Blitz IP Limit Service, а реализовать свое на уровне приложения:
- Сервер отслеживает до 3 устройств на пользователя (device_id, IP, first_seen, last_seen)
- При первом подключении нового устройства проверяется лимит
- Если лимит превышен, клиент получит ошибку `deviceLimitReached`
- Ключ VPN сам остается рабочим, просто приложение блокирует доступ

Преимущества:
- Больше контроля
- Легко удалить старое устройство через приложение
- Работает независимо от версии Blitz panel
